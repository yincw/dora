import { nodeResolve } from '@rollup/plugin-node-resolve';
import { uglify } from 'rollup-plugin-uglify';
import { minify } from 'uglify-es';
import typescript from '@rollup/plugin-typescript';
import json from '@rollup/plugin-json';
import pkg from './package.json';

const banner = `/*!* ${pkg.name.split('/').slice(-1)}.js v${pkg.version} \n * (c) 2019-${new Date().getFullYear()} ${pkg.author} \n * Released under the MIT License. \n */`;


export default {
    input: 'src/index.ts',
    output: {
        format: 'umd',  // umd, iife
        name: 'dora',
        banner,
        file: pkg.browser
    },
    plugins: [
        typescript(),
        json(),
        nodeResolve(),
        uglify({
            compress: {
                drop_console: true,
            },
            output: {
                comments: /^!/,
            }
        }, minify),
    ]

}